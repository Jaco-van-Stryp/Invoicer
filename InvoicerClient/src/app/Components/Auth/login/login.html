<div class="login-container">
  <div class="absolute top-8 left-8">
    <logo />
  </div>
  <p-card class="login-card">
    @if (step() === 'email') {
      <div class="flex flex-col gap-2 text-center mb-6">
        <h1 class="text-3xl font-bold">Welcome Back!</h1>
        <p class="text-lg text-muted-color">
          Sign in to continue to Invoicer.
        </p>
      </div>
      <div class="flex flex-col gap-5">
        <p-floatLabel>
          <input
            pInputText
            id="email"
            type="email"
            class="w-full"
            [ngModel]="email()"
            (ngModelChange)="email.set($event)"
            autocomplete="email"
          />
          <label for="email">Email</label>
        </p-floatLabel>
        <p-button
          label="Send Code"
          icon="pi pi-arrow-right"
          iconPos="right"
          [loading]="loading()"
          [disabled]="!isEmailValid()"
          styleClass="w-full"
          (click)="requestOtp()"
        />
        <div class="mt-4 text-center text-sm">
          Don't have an account?
          <a routerLink="/register" class="underline"> Sign up </a>
        </div>
      </div>
    } @else {
      <div class="flex flex-col items-center gap-5">
        <div class="text-center">
          <h2 class="text-2xl font-bold m-0">Check your inbox</h2>
          <p class="text-muted-color mt-1">
            We sent a 6-digit code to
            <br />
            <strong>{{ email() }}</strong>
          </p>
        </div>

        <p-inputOtp [ngModel]="otpCode()" (ngModelChange)="otpCode.set($event)" [length]="6" />

        <p-button
          label="Verify & Login"
          icon="pi pi-check"
          [loading]="loading()"
          [disabled]="!isOtpComplete()"
          styleClass="w-full"
          (click)="login()"
        />

        <div class="flex items-center justify-between w-full">
          <p-button
            label="Back"
            icon="pi pi-arrow-left"
            [text]="true"
            size="small"
            (click)="backToEmail()"
          />
          <p-button
            label="Resend code"
            icon="pi pi-refresh"
            [text]="true"
            size="small"
            [disabled]="resendTimer() > 0"
            [pTooltip]="resendTimer() > 0 ? 'Resend code in ' + resendTimer() + 's' : undefined"
            tooltipPosition="bottom"
            (click)="requestOtp()"
          />
        </div>
      </div>
    }
  </p-card>
  <div class="absolute bottom-4 left-4">
    <copyright />
  </div>
</div>
